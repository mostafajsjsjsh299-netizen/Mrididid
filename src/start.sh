#!/bin/bash

# ุณูุฑูุจุช ุชุดุบูู ุงูุจูุช

echo "๐ ุจุฏุก ุชุดุบูู ุจูุช NuMbEr SmS..."
echo ""

# ุงูุชุญูู ูู ูุฌูุฏ Python
if ! command -v python3 &> /dev/null
then
    echo "โ Python 3 ุบูุฑ ูุซุจุช!"
    exit 1
fi

# ุงูุชุญูู ูู ูุฌูุฏ ุงูููุชุจุงุช
echo "๐ฆ ุงูุชุญูู ูู ุงูููุชุจุงุช ุงููุทููุจุฉ..."
python3 -c "import telegram" 2>/dev/null || {
    echo "โ๏ธ  ุงูููุชุจุงุช ุบูุฑ ูุซุจุชุฉ. ุฌุงุฑู ุงูุชุซุจูุช..."
    pip3 install -r requirements.txt
}

# ุงูุชุญูู ูู ููู ุงูุฅุนุฏุงุฏุงุช
if grep -q "YOUR_BOT_TOKEN_HERE" config.py; then
    echo "โ๏ธ  ุชุญุฐูุฑ: ูู ูุชู ุชุนุฏูู ููู config.py ุจุนุฏ!"
    echo "๐ ูุฑุฌู ุชุนุฏูู ููู config.py ูุฅุถุงูุฉ:"
    echo "   - ุชููู ุงูุจูุช (BOT_TOKEN)"
    echo "   - API_ID ู API_HASH"
    echo "   - ูุนุฑูุงุช ุงููููุงุช"
    echo ""
    # read -p "ูู ุชุฑูุฏ ุงููุชุงุจุนุฉ ุนูู ุฃู ุญุงูุ (y/n) " -n 1 -r
    # echo ""
    # if [[ ! $REPLY =~ ^[Yy]$ ]]
    # then
    #     exit 1
    # fi
fi

# ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
if [ ! -f "bot_database.db" ]; then
    echo "๐๏ธ  ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
    python3 -c "from database import Base, engine; Base.metadata.create_all(engine)"
fi

echo ""
echo "โ ุฌุงูุฒ ููุชุดุบูู!"
echo "๐ฑ ุงูุจูุช ูุนูู ุงูุขู..."
echo "โ๏ธ  ุงุถุบุท Ctrl+C ูุฅููุงู ุงูุจูุช"
echo ""

# ุชุดุบูู ุงูุจูุช ูู ุญููุฉ ุชูุฑุงุฑูุฉ ูุถูุงู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุชููุงุฆู ุนูุฏ ุงูุชููู
while true; do
    python3 bot.py
    echo "โ๏ธ ุงูุจูุช ุชููู ุนู ุงูุนูู! ุณูุชู ุฅุนุงุฏุฉ ุงูุชุดุบูู ุฎูุงู 5 ุซูุงูู..."
    sleep 5
done
